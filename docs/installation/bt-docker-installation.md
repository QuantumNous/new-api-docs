# 宝塔面板Docker安装指南

本文档提供了使用宝塔面板Docker功能部署New API的图文教程。

## 前置要求

- 安装宝塔面板 9.2.0 及以上版本
- 推荐系统：CentOS 7+、Ubuntu 18.04+、Debian 10+
- 服务器配置：至少1核2G内存

## 安装宝塔面板

1. 前往[宝塔面板官网](https://www.bt.cn/new/download.html)下载适合您系统的安装脚本
2. 运行安装脚本安装宝塔面板
3. 安装完成后，使用提供的地址、用户名和密码登录到宝塔面板

## 安装Docker

1. 登录宝塔面板后，在左侧菜单栏找到并点击 **Docker**
2. 首次进入会提示安装Docker服务，点击 **立即安装**
3. 按照提示完成Docker服务的安装

## 安装New API

### 方法一：使用宝塔应用商店（推荐）

1. 在宝塔面板Docker功能中，点击 **应用商店**
2. 搜索并找到 **New-API**
3. 点击 **安装**
4. 配置以下基本选项：
   - 容器名称：可自定义，默认为`new-api`
   - 端口映射：默认为`3000:3000`
   - 环境变量：根据需要添加（如TZ=Asia/Shanghai等）
   - 目录映射：确保将`/data`目录映射到主机目录
5. 点击 **提交**，完成安装

### 方法二：使用自定义镜像

> 强烈建议通过“应用商店”安装并自动完成配置。本节为高级用法，适合明确了解Docker与宝塔容器配置的用户。

??? warning "我确认要手动设置镜像，出现问题自行解决"
    仅在您勾选并同意上述确认后，再参考以下步骤手动配置自定义镜像：

    1. 在宝塔面板Docker功能中，点击 **镜像管理**
    2. 点击 **获取镜像** -> **拉取镜像**
    3. 输入镜像名称：`calciumion/new-api:latest`
    4. 点击 **提交**，等待镜像拉取完成
    5. 拉取完成后，进入 **容器列表**，点击 **创建容器**
    6. 填写以下信息：
       - 容器名称：`new-api`（可自定义）
       - 镜像：选择刚刚拉取的`calciumion/new-api:latest`
       - 端口映射：添加`3000:3000`
       - 目录映射：添加`/your/host/path:/data`（替换为您的主机路径）
       - 环境变量：根据需要添加（如TZ=Asia/Shanghai等）
    7. 点击 **提交**，完成安装

## 配置与访问

安装完成后，您可以通过以下地址访问New API：

    http://服务器IP:3000

首次访问将自动引导到初始化页面。按照页面指引设置管理员账号与密码（仅首次安装需要），完成后使用所设置的管理员账号登录。

## 常见问题

### 1. 无法访问New API界面

- 检查端口映射是否正确
- 确认服务器防火墙是否放行3000端口
- 查看容器是否正常运行

### 2. 数据无法持久化

- 确认是否正确映射了`/data`目录
- 检查主机目录权限是否正确

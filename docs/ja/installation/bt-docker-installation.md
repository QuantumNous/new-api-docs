# 宝塔パネル Docker インストールガイド

本ドキュメントでは、宝塔パネルのDocker機能を使用してNew APIをデプロイするための図解チュートリアルを提供します。

## 前提条件

- 宝塔パネル 9.2.0 以降のバージョンがインストールされていること
- 推奨システム：CentOS 7+、Ubuntu 18.04+、Debian 10+
- サーバー構成：最低 1コア 2GB メモリ

## 宝塔パネルのインストール

1. [宝塔パネル公式サイト](https://www.bt.cn/new/download.html)にアクセスし、お使いのシステムに適したインストールスクリプトをダウンロードします
2. インストールスクリプトを実行して宝塔パネルをインストールします
3. インストール完了後、提供されたアドレス、ユーザー名、パスワードを使用して宝塔パネルにログインします

## Dockerのインストール

1. 宝塔パネルにログイン後、左側のメニューバーにある **Docker** を見つけてクリックします
2. 初回アクセス時にはDockerサービスのインストールを促すメッセージが表示されるため、**すぐにインストール** をクリックします
3. プロンプトに従ってDockerサービスのインストールを完了します

## New APIのインストール

### 方法一：宝塔アプリケーションストアの使用（推奨）

1. 宝塔パネルのDocker機能内で、**アプリケーションストア** をクリックします
2. **New-API** を検索して見つけます
3. **インストール** をクリックします
4. 以下の基本オプションを設定します：
   - コンテナ名：カスタマイズ可能、デフォルトは`new-api`
   - ポートマッピング：デフォルトは`3000:3000`
   - 環境変数：必要に応じて追加します（例：TZ=Asia/Shanghaiなど）
   - ディレクトリマッピング：`/data`ディレクトリがホストディレクトリにマッピングされていることを確認してください
5. **送信** をクリックして、インストールを完了します

### 方法二：カスタムイメージの使用

> 「アプリケーションストア」を通じてインストールし、自動で設定を完了することを強く推奨します。本セクションは上級者向けであり、Dockerと宝塔コンテナの設定を明確に理解しているユーザーに適しています。

??? warning "手動でイメージを設定することを確認し、問題が発生した場合は自己解決します"
    上記の確認にチェックを入れ、同意した場合にのみ、以下の手順を参照してカスタムイメージを手動で設定してください：

    1. 宝塔パネルのDocker機能内で、**イメージ管理** をクリックします
    2. **イメージを取得** -> **イメージをプル** をクリックします
    3. イメージ名を入力します：`calciumion/new-api:latest`
    4. **送信** をクリックし、イメージのプルが完了するのを待ちます
    5. プル完了後、**コンテナリスト** に移動し、**コンテナを作成** をクリックします
    6. 以下の情報を入力します：
       - コンテナ名：`new-api`（カスタマイズ可能）
       - イメージ：プルしたばかりの`calciumion/new-api:latest`を選択
       - ポートマッピング：`3000:3000`を追加
       - ディレクトリマッピング：`/your/host/path:/data`を追加（ご自身のホストパスに置き換えてください）
       - 環境変数：必要に応じて追加します（例：TZ=Asia/Shanghaiなど）
    7. **送信** をクリックして、インストールを完了します

## 設定とアクセス

インストール完了後、以下のURLを通じてNew APIにアクセスできます：

    http://服务器IP:3000

初回アクセス時には、自動的に初期化ページに誘導されます。ページの手順に従って管理者アカウントとパスワードを設定し（初回インストール時のみ必要）、完了後、設定した管理者アカウントでログインしてください。

## よくある質問

### 1. New APIインターフェースにアクセスできない

- ポートマッピングが正しいか確認してください
- サーバーのファイアウォールで3000番ポートが許可されているか確認してください
- コンテナが正常に実行されているか確認してください

### 2. データが永続化されない

- `/data`ディレクトリが正しくマッピングされているか確認してください
- ホストディレクトリの権限が正しいか確認してください
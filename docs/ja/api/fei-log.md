# ãƒ­ã‚°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

!!! info "æ©Ÿèƒ½èª¬æ˜"
    ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¯ http(s)://`<your-domain>` ã«çµ±ä¸€ã•ã‚Œã¦ã„ã¾ã™

    æœ¬ç•ªç’°å¢ƒã§ã¯èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿è­·ã™ã‚‹ãŸã‚ã« HTTPS ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ HTTP ã¯é–‹ç™ºç’°å¢ƒã§ã®ã¿æ¨å¥¨ã•ã‚Œã¾ã™ã€‚

    éšå±¤åŒ–ã•ã‚ŒãŸãƒ­ã‚°ã‚¯ã‚¨ãƒªã‚·ã‚¹ãƒ†ãƒ ã¯ã€ç®¡ç†è€…ãŒå…¨ã‚µã‚¤ãƒˆã®ãƒ­ã‚°ã‚’è¡¨ç¤ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå€‹äººã®ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆï¼ˆRPM/TPMï¼‰ã€å¤šæ¬¡å…ƒãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãªã©ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚CORSã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã‚¯ã‚¨ãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯ã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£çµ±åˆã‚’å®¹æ˜“ã«ã—ã¾ã™ã€‚

## ğŸ” èªè¨¼ä¸è¦

### ãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚ˆã‚‹ãƒ­ã‚°æ¤œç´¢

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚ˆã‚‹ãƒ­ã‚°æ¤œç´¢
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šGET
- **ãƒ‘ã‚¹**ï¼š`/api/log/token`
- **èªè¨¼è¦ä»¶**ï¼šå…¬é–‹
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šãƒˆãƒ¼ã‚¯ãƒ³ã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦é–¢é€£ã™ã‚‹ãƒ­ã‚°è¨˜éŒ²ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆCORSï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/token?key=<TOKEN_PLACEHOLDER>', {  
  method: 'GET',  
  headers: {  
    'Content-Type': 'application/json'  
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": [  
    {  
      "id": 1,  
      "type": 2,  
      "content": "APIè°ƒç”¨æˆåŠŸ",  
      "model_name": "gpt-4",  
      "quota": 1000,  
      "created_at": 1640995000  
    }  
  ]  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "Tokenä¸å­˜åœ¨æˆ–æ— æƒé™"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

`key` ï¼ˆæ–‡å­—åˆ—ï¼‰: ãƒˆãƒ¼ã‚¯ãƒ³ã‚­ãƒ¼ã€‚å¿…é ˆã€‚

## ğŸ” ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼

### ãƒã‚¤ãƒ­ã‚°çµ±è¨ˆ

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šãƒã‚¤ãƒ­ã‚°çµ±è¨ˆ
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šGET
- **ãƒ‘ã‚¹**ï¼š`/api/log/self/stat`
- **èªè¨¼è¦ä»¶**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°çµ±è¨ˆæƒ…å ±ï¼ˆã‚¯ã‚©ãƒ¼ã‚¿æ¶ˆè²»ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦ã€ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ã‚’å«ã‚€ï¼‰ã‚’å–å¾—ã—ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/self/stat?type=2&start_timestamp=1640908800&end_timestamp=1640995200&token_name=api_token&model_name=gpt-4&group=default', {  
  method: 'GET',  
  headers: {  
    'Content-Type': 'application/json',  
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": {  
    "quota": 50000,  
    "rpm": 10,  
    "tpm": 1500  
  }  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

- `type` ï¼ˆæ•°å­—ï¼‰: ãƒ­ã‚°ã‚¿ã‚¤ãƒ—ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³å€¤ï¼š1=ãƒãƒ£ãƒ¼ã‚¸ã€2=æ¶ˆè²»ã€3=ç®¡ç†ã€4=ã‚¨ãƒ©ãƒ¼ã€5=ã‚·ã‚¹ãƒ†ãƒ 
- `start_timestamp` ï¼ˆæ•°å­—ï¼‰: é–‹å§‹ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- `end_timestamp` ï¼ˆæ•°å­—ï¼‰: çµ‚äº†ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- `token_name` ï¼ˆæ–‡å­—åˆ—ï¼‰: ãƒˆãƒ¼ã‚¯ãƒ³åã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- `model_name` ï¼ˆæ–‡å­—åˆ—ï¼‰: ãƒ¢ãƒ‡ãƒ«åã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- `group` ï¼ˆæ–‡å­—åˆ—ï¼‰: ã‚°ãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- `quota` ï¼ˆæ•°å­—ï¼‰: æŒ‡å®šã•ã‚ŒãŸæ™‚é–“ç¯„å›²å†…ã®ç·ã‚¯ã‚©ãƒ¼ã‚¿æ¶ˆè²»é‡
- `rpm` ï¼ˆæ•°å­—ï¼‰: 1åˆ†ã‚ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ï¼ˆç›´è¿‘60ç§’ï¼‰
- `tpm` ï¼ˆæ•°å­—ï¼‰: 1åˆ†ã‚ãŸã‚Šã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ï¼ˆç›´è¿‘60ç§’ï¼‰

### ãƒã‚¤ãƒ­ã‚°ã®å–å¾—

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šãƒã‚¤ãƒ­ã‚°ã®å–å¾—
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šGET
- **ãƒ‘ã‚¹**ï¼š`/api/log/self`
- **èªè¨¼è¦ä»¶**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°è¨˜éŒ²ã‚’ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã§å–å¾—ã—ã¾ã™ã€‚è¤‡æ•°ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/self?p=1&page_size=20&type=2&start_timestamp=1640908800&end_timestamp=1640995200&token_name=api_token&model_name=gpt-4&group=default', {  
  method: 'GET',  
  headers: {  
    'Content-Type': 'application/json',  
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": {  
    "items": [  
      {  
        "id": 1,  
        "user_id": 1,  
        "created_at": 1640995000,  
        "type": 2,  
        "content": "APIè°ƒç”¨æˆåŠŸ",  
        "token_name": "api_token",  
        "model_name": "gpt-4",  
        "quota": 1000,  
        "prompt_tokens": 50,  
        "completion_tokens": 100  
      }  
    ],  
    "total": 25,  
    "page": 1,  
    "page_size": 20  
  }  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "è·å–æ—¥å¿—å¤±è´¥"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å…¨ãƒ­ã‚°å–å¾—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨åŒã˜ã§ã™ãŒã€ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°è¨˜éŒ²ã®ã¿ã‚’è¿”ã—ã¾ã™

### ãƒã‚¤ãƒ­ã‚°ã®æ¤œç´¢

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šãƒã‚¤ãƒ­ã‚°ã®æ¤œç´¢
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šGET
- **ãƒ‘ã‚¹**ï¼š`/api/log/self/search`
- **èªè¨¼è¦ä»¶**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«åŸºã¥ã„ã¦ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°è¨˜éŒ²ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/self/search?keyword=gpt-4', {  
  method: 'GET',  
  headers: {  
    'Content-Type': 'application/json',  
    'Authorization': 'Bearer your_user_token',
    'New-Api-User': 'your_user_id'
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": [  
    {  
      "id": 1,  
      "type": 2,  
      "content": "GPT-4è°ƒç”¨æˆåŠŸ",  
      "model_name": "gpt-4",  
      "created_at": 1640995000  
    }  
  ]  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "æœç´¢æ—¥å¿—å¤±è´¥"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

`keyword` ï¼ˆæ–‡å­—åˆ—ï¼‰: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€‚ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°ã‚¿ã‚¤ãƒ—ã«ä¸€è‡´ã—ã¾ã™ã€‚

## ğŸ” ç®¡ç†è€…èªè¨¼

### å…¨ãƒ­ã‚°ã®å–å¾—

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šå…¨ãƒ­ã‚°ã®å–å¾—
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šGET
- **ãƒ‘ã‚¹**ï¼š`/api/log/`
- **èªè¨¼è¦ä»¶**ï¼šç®¡ç†è€…
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šã‚·ã‚¹ãƒ†ãƒ å†…ã®ã™ã¹ã¦ã®ãƒ­ã‚°è¨˜éŒ²ã‚’ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã§å–å¾—ã—ã¾ã™ã€‚è¤‡æ•°ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã¨ãƒ­ã‚°ã‚¿ã‚¤ãƒ—ã«ã‚ˆã‚‹çµã‚Šè¾¼ã¿ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/?p=1&page_size=20&type=2&start_timestamp=1640908800&end_timestamp=1640995200&username=testuser&token_name=api_token&model_name=gpt-4&channel=1&group=default', {  
  method: 'GET',  
  headers: {  
    'Content-Type': 'application/json',  
    'Authorization': 'Bearer your_admin_token',
    'New-Api-User': 'your_user_id'
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": {  
    "items": [  
      {  
        "id": 1,  
        "user_id": 1,  
        "created_at": 1640995000,  
        "type": 2,  
        "content": "APIè°ƒç”¨æˆåŠŸ",  
        "username": "testuser",  
        "token_name": "api_token",  
        "model_name": "gpt-4",  
        "quota": 1000,  
        "prompt_tokens": 50,  
        "completion_tokens": 100,  
        "use_time": 2,  
        "is_stream": false,  
        "channel_id": 1,  
        "channel_name": "OpenAIæ¸ é“",  
        "token_id": 1,  
        "group": "default",  
        "ip": "192.168.1.1",  
        "other": "{\"model_ratio\":15.0}"  
      }  
    ],  
    "total": 100,  
    "page": 1,  
    "page_size": 20  
  }  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "è·å–æ—¥å¿—å¤±è´¥"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

- `p` ï¼ˆæ•°å­—ï¼‰: ãƒšãƒ¼ã‚¸ç•ªå·ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ 1ã€‚
- `page_size` ï¼ˆæ•°å­—ï¼‰: 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®ä»¶æ•°ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ 20ã€‚
- `type` ï¼ˆæ•°å­—ï¼‰: ãƒ­ã‚°ã‚¿ã‚¤ãƒ—ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³å€¤ï¼š1=ãƒãƒ£ãƒ¼ã‚¸ã€2=æ¶ˆè²»ã€3=ç®¡ç†ã€4=ã‚¨ãƒ©ãƒ¼ã€5=ã‚·ã‚¹ãƒ†ãƒ  log.goï¼š41-48
- `start_timestamp` ï¼ˆæ•°å­—ï¼‰: é–‹å§‹ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- `end_timestamp` ï¼ˆæ•°å­—ï¼‰: çµ‚äº†ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
- `username` ï¼ˆæ–‡å­—åˆ—ï¼‰: ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- `token_name` ï¼ˆæ–‡å­—åˆ—ï¼‰: ãƒˆãƒ¼ã‚¯ãƒ³åã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- `model_name` ï¼ˆæ–‡å­—åˆ—ï¼‰: ãƒ¢ãƒ‡ãƒ«åã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- `channel` ï¼ˆæ•°å­—ï¼‰: ãƒãƒ£ãƒãƒ« ID ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- `group` ï¼ˆæ–‡å­—åˆ—ï¼‰: ã‚°ãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

### å±¥æ­´ãƒ­ã‚°ã®å‰Šé™¤

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šå±¥æ­´ãƒ­ã‚°ã®å‰Šé™¤
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šDELETE
- **ãƒ‘ã‚¹**ï¼š`/api/log/`
- **èªè¨¼è¦ä»¶**ï¼šç®¡ç†è€…
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šæŒ‡å®šã•ã‚ŒãŸã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»¥å‰ã®å±¥æ­´ãƒ­ã‚°è¨˜éŒ²ã‚’ä¸€æ‹¬å‰Šé™¤ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è² è·ãŒé«˜ããªã‚‹ã®ã‚’é¿ã‘ã‚‹ãŸã‚ã€ãƒãƒƒãƒå‰Šé™¤ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/?target_timestamp=1640908800', {  
  method: 'DELETE',  
  headers: {  
    'Content-Type': 'application/json',  
    'Authorization': 'Bearer your_admin_token',
    'New-Api-User': 'your_user_id'
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": 1500  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "target timestamp is required"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

- `target_timestamp` ï¼ˆæ•°å­—ï¼‰: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã€‚ã“ã®æ™‚é–“ä»¥å‰ã®ã™ã¹ã¦ã®ãƒ­ã‚°ã‚’å‰Šé™¤ã—ã¾ã™ã€‚å¿…é ˆã€‚
- `data` ï¼ˆæ•°å­—ï¼‰: æ­£å¸¸ã«å‰Šé™¤ã•ã‚ŒãŸãƒ­ã‚°ã®æ¡æ•°

### ãƒ­ã‚°çµ±è¨ˆ

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šãƒ­ã‚°çµ±è¨ˆ
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šGET
- **ãƒ‘ã‚¹**ï¼š`/api/log/stat`
- **èªè¨¼è¦ä»¶**ï¼šç®¡ç†è€…
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šæŒ‡å®šã•ã‚ŒãŸæ™‚é–“ç¯„å›²ã¨æ¡ä»¶ã«åŸºã¥ã„ãŸãƒ­ã‚°çµ±è¨ˆæƒ…å ±ï¼ˆã‚¯ã‚©ãƒ¼ã‚¿æ¶ˆè²»ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦ã€ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ã‚’å«ã‚€ï¼‰ã‚’å–å¾—ã—ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/stat?type=2&start_timestamp=1640908800&end_timestamp=1640995200&username=testuser&token_name=api_token&model_name=gpt-4&channel=1&group=default', {  
  method: 'GET',  
  headers: {  
    'Content-Type': 'application/json',  
    'Authorization': 'Bearer your_admin_token',
    'New-Api-User': 'your_user_id' 
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": {  
    "quota": 150000,  
    "rpm": 25,  
    "tpm": 3500  
  }  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

- ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å…¨ãƒ­ã‚°å–å¾—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨åŒã˜ã§ã™
- `quota` ï¼ˆæ•°å­—ï¼‰: æŒ‡å®šã•ã‚ŒãŸæ™‚é–“ç¯„å›²å†…ã®ç·ã‚¯ã‚©ãƒ¼ã‚¿æ¶ˆè²»é‡
- `rpm` ï¼ˆæ•°å­—ï¼‰: 1åˆ†ã‚ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ï¼ˆç›´è¿‘60ç§’ï¼‰ log.goï¼š357
- `tpm` ï¼ˆæ•°å­—ï¼‰: 1åˆ†ã‚ãŸã‚Šã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ï¼ˆç›´è¿‘60ç§’ã® prompt_tokens + completion_tokens ã®åˆè¨ˆï¼‰

### å…¨ãƒ­ã‚°ã®æ¤œç´¢

- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å**ï¼šå…¨ãƒ­ã‚°ã®æ¤œç´¢
- **HTTP ãƒ¡ã‚½ãƒƒãƒ‰**ï¼šGET
- **ãƒ‘ã‚¹**ï¼š`/api/log/search`
- **èªè¨¼è¦ä»¶**ï¼šç®¡ç†è€…
- **æ©Ÿèƒ½æ¦‚è¦**ï¼šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«åŸºã¥ã„ã¦ã‚·ã‚¹ãƒ†ãƒ å†…ã®ã™ã¹ã¦ã®ãƒ­ã‚°è¨˜éŒ²ã‚’æ¤œç´¢ã—ã¾ã™ã€‚

ğŸ’¡ ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ï¼š

```
const response = await fetch('/api/log/search?keyword=error', {  
  method: 'GET',  
  headers: {  
    'Content-Type': 'application/json',  
    'Authorization': 'Bearer your_admin_token',
    'New-Api-User': 'your_user_id'
  }  
});  
const data = await response.json();
```

âœ… æˆåŠŸå¿œç­”ä¾‹ï¼š

```
{  
  "success": true,  
  "message": "",  
  "data": [  
    {  
      "id": 1,  
      "type": 4,  
      "content": "APIè°ƒç”¨é”™è¯¯",  
      "username": "testuser",  
      "created_at": 1640995000  
    }  
  ]  
}
```

â— å¤±æ•—å¿œç­”ä¾‹ï¼š

```
{  
  "success": false,  
  "message": "æœç´¢æ—¥å¿—å¤±è´¥"  
}
```

ğŸ§¾ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜ï¼š

`keyword` ï¼ˆæ–‡å­—åˆ—ï¼‰: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€‚ãƒ­ã‚°ã‚¿ã‚¤ãƒ—ã¾ãŸã¯å†…å®¹ã«ä¸€è‡´ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚